**Примечание**:
Заметка не относится к методу k-NN, но нужна для понимания [[Метод парзеновского окна (Parzen window classifier)|метода парзеновского окна]].

**Ядро** в [[Математическая статистика (Mathematical statistics)|статистике]] - это неотрицательная интегрируемая функция, с областью вещественной областью значения. Обозначается буквой $K$. Должна обладать свойством нормирования:$$\int_{-\infty}^{+\infty} K(u)du=1$$**Примеры** ядерных функций:

- **Равномерное** (прямоугольное, постоянное) ядро:$$K(u)=\frac{1}{2},\quad |u| \leq 1$$
- **Треугольное** ядро:$$K(u)=1-|u|,\quad |u| \leq 1$$
- **Епанечниково** (параболическое) ядро (от имени В.А. Епанечникова):$$K(u)=\frac{3}{4}(1-u^2),\quad |u| \leq 1$$

**Ядерная оценка плотности** (KDE), или **метод Парзена-Розенблатта** - непараметрический способ оценки плотности случайной величины. Ядерная оценка плотности является задачей **сглаживания** данных, когда делается заключение о совокупности, основываясь на конечных выборках данных.

Пусть $(x_1,...,x_n)$ является одномерной выборкой независимых одинаково распределённых величин, извлечённых из некоторого распределения с неизвестной плотностью $f$. Задача заключается в оценке функции $f$. Её ядерный оценщик плотности равен:$$\hat{f}_h(x)=\frac{1}{n}\sum_{i=1}^nK_h(x-x_i)=\frac{1}{nh}\sum_{i=1}^nK\Big(\frac{x-x_i}{h}\Big),$$где $K$ является **ядром**, то есть неотрицательной функцией, а $h > 0$ является сглаживающим параметром, называемым **шириной окна**.

Для **многомерной выборки** размерности $d$, оценка плотности примет вид:$$\hat{f}_h(x)=\frac{1}{nh^d}\sum_{i=1}^nK\Big(\frac{x-x_i}{h}\Big),$$где $\frac{1}{nh^d}$ - это нормирующий коэффициент - требование для перехода к плотности вероятности; $n$ - сколько всего ядер суммируется; $h^d$ - точное значение интеграла ядерной функции: $\int_{-\infty}^{+\infty}K(\frac{x-x_i}{h})d{\frac{x-x_i}{h}} = h^d$, если $\dim(x) = d$.

**Интуитивное понимание метода** KDE:
Есть некоторая выборка. Оценка плотности распределения случайной величины по выборке представляет из себя кусочно-постоянную функцию с разрывами. Ядерный метод позволяет сгладить разрывы внутри окна. **Узкое окно** - слабое сглаживание (undersmoothing) - приводит к шумной оценке. **Широкое окно** - сильное сглаживание (oversmoothing) - приводит к смещённо оценке. Существуют методы оценки оптимального размера окна. 

**Пример**:
Покажем работу **ширины окна** $h$ на примере **треугольного ядра**:$$K(\frac{x-x_i}{h})=1-|\frac{x-x_i}{h}|,\quad |\frac{x-x_i}{h}| \leq 1,\quad i=\overline{1,n}.$$Выражение $|\frac{x-x_i}{h}| \leq 1$ справедливо, когда ширина окна $h$ по модулю больше, или равна разности $x-x_i$. Таким образом, ширина окна **определяет**, какие элементы выборки попадут в оценку плотности в точке $x$. Остальные элементы выборки зануляются.